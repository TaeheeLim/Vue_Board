var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,o,n)=>o in e?__defProp(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,__spreadValues=(e,o)=>{for(var n in o||(o={}))__hasOwnProp.call(o,n)&&__defNormalProp(e,n,o[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(o))__propIsEnum.call(o,n)&&__defNormalProp(e,n,o[n]);return e},__spreadProps=(e,o)=>__defProps(e,__getOwnPropDescs(o));!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).Tree={},e.Vue)}(this,(function(e,o){"use strict";const n={},t={xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-right"},d=o.createVNode("polyline",{points:"9 18 15 12 9 6"},null,-1);n.render=function(e,n){return o.openBlock(),o.createBlock("svg",t,[d])};const r={},c={xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-down"},a=o.createVNode("polyline",{points:"6 9 12 15 18 9"},null,-1);r.render=function(e,n){return o.openBlock(),o.createBlock("svg",c,[a])};const l={},s={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-x"},i=o.createVNode("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),u=o.createVNode("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1);l.render=function(e,n){return o.openBlock(),o.createBlock("svg",s,[i,u])};const p={components:{ArrowRight:n,ArrowDown:r,DeleteIcon:l},props:{node:{type:Object,required:!0},indentSize:{type:Number,required:!0},gap:{type:Number,required:!0},getNode:{type:Function,required:!0},setNode:{type:Function,required:!0},updateNode:{type:Function,required:!0},expandRowByDefault:{type:Boolean,default:!1},useCheckbox:{type:Boolean,default:!1},useIcon:{type:Boolean,default:!0},useRowDelete:{type:Boolean,default:!1},showChildCount:{type:Boolean,default:!1},rowHoverBackground:{type:String,default:"#e0e0e0"},expandable:{type:Boolean,default:!0}},emits:["nodeExpanded","checkboxToggle","deleteRow"],setup(e,{emit:n}){o.watch((()=>e.expandRowByDefault),(o=>{e.node.nodes&&(e.node.expanded=!e.expandable)}),{immediate:!0});return{childCount:o.computed((()=>{var o;return null==(o=e.node.nodes)?void 0:o.length})),checkedChildCount:o.computed((()=>{var o;return null==(o=e.node.nodes)?void 0:o.filter((e=>e.checked)).length})),toggleExpanded:t=>{e.expandable&&(e.node.expanded=!!e.node.nodes&&!e.node.expanded,o.nextTick((()=>{n("nodeExpanded",t,e.node.expanded)})))},onNodeExpanded:(e,o)=>{n("nodeExpanded",e,o)},toggleCheckbox:()=>{const{node:o,updateNode:n}=e;n(o.id,{checked:!o.checked})},onCheckboxToggle:(e,o)=>{n("checkboxToggle",e,o)},removedRow:e=>{n("deleteRow",e)}}}},h={key:0,class:"tree-row-item-icon-wrapper"},k={class:"tree-row-txt"},w={class:"child-count"};function g(e){const o=e=>(e.forEach((e=>{e.checked=!1,e.expanded=!1,e.indeterminate=!1,Array.isArray(e.nodes)&&o(e.nodes)})),e);return o(e)}function x(e,o){for(let n=0;n<e.length;n++){const t=e[n];if(t.id===o)return t;if(Array.isArray(t.nodes)){const e=x(t.nodes,o);if(e)return e}}}function f(e,o,n){for(let t=0;t<e.length;t++){const d=e[t];d.id===o?e[t]=__spreadValues({id:o},n):Array.isArray(d.nodes)&&(e[t].nodes=f(d.nodes,o,n))}return e}function y(e,o){const n=void 0!==o?o:e.checked;return e.checked=n,e&&Array.isArray(e.nodes)&&(e.nodes=e.nodes.map((e=>__spreadProps(__spreadValues({},e),{checked:n,nodes:e.nodes?e.nodes.map((e=>y(e,n))):void 0})))),e}function b(e,o,n){for(let t=0;t<e.length;t++){const d=e[t];d.id===o?e[t]=y(__spreadValues(__spreadValues({},d),n)):Array.isArray(d.nodes)&&(e[t].nodes=b(d.nodes,o,n))}return e}function m(e){return e.map((e=>{if(e.nodes){e.nodes=m(e.nodes);const o=e.nodes.every((e=>e.checked)),n=e.nodes.some((e=>e.checked)),t=e.nodes.some((e=>e.indeterminate));o?(e.checked=!0,e.indeterminate=!1):n||t?(e.checked=!1,e.indeterminate=!0):o||(e.checked=!1,e.indeterminate=!1)}else e.expanded&&(e.expanded=!1);return e}))}function v(e,o){if(!Array.isArray(e))return;let n=[...e];for(let t=0;t<e.length;t++){const d=e[t];d.id===o?n=n.filter((e=>e.id!==o)):d.nodes&&(d.nodes=v(d.nodes,o),d.nodes.length||delete d.nodes)}return n}p.render=function(e,n,t,d,r,c){const a=o.resolveComponent("arrow-right"),l=o.resolveComponent("arrow-down"),s=o.resolveComponent("delete-icon"),i=o.resolveComponent("tree-row",!0);return o.openBlock(),o.createBlock("li",{class:"tree-row",style:{"padding-left":t.indentSize+"px",gap:t.gap+"px","--row-hover-background":t.rowHoverBackground}},[o.createVNode("div",{class:"tree-row-item",onClick:n[4]||(n[4]=o.withModifiers((e=>d.toggleExpanded(t.node)),["stop"]))},[t.useIcon?(o.openBlock(),o.createBlock("div",h,[t.node.nodes?(o.openBlock(),o.createBlock(o.Fragment,{key:0},[t.node.expanded?o.renderSlot(e.$slots,"iconInactive",{key:1},(()=>[o.createVNode(l)])):o.renderSlot(e.$slots,"iconActive",{key:0},(()=>[o.createVNode(a)]))],64)):o.createCommentVNode("",!0)])):o.createCommentVNode("",!0),o.renderSlot(e.$slots,"checkbox",{id:t.node.id,checked:t.node.checked,indeterminate:t.node.indeterminate}),t.useCheckbox?o.withDirectives((o.openBlock(),o.createBlock("input",{key:1,"onUpdate:modelValue":n[1]||(n[1]=e=>t.node.checked=e),type:"checkbox",checked:t.node.checked,indeterminate:t.node.indeterminate,onClick:n[2]||(n[2]=o.withModifiers(((...e)=>d.toggleCheckbox&&d.toggleCheckbox(...e)),["stop"]))},null,8,["checked","indeterminate"])),[[o.vModelCheckbox,t.node.checked]]):o.createCommentVNode("",!0),o.createVNode("span",k,o.toDisplayString(t.node.label),1),t.node.nodes&&t.showChildCount?o.renderSlot(e.$slots,"childCount",{key:2,count:d.childCount,checkedCount:d.checkedChildCount,childs:t.node.nodes},(()=>[o.createVNode("span",w,o.toDisplayString(d.childCount),1)])):o.createCommentVNode("",!0),t.node&&t.useRowDelete?(o.openBlock(),o.createBlock("div",{key:3,class:"delete-icon",onClick:n[3]||(n[3]=o.withModifiers((e=>d.removedRow(t.node)),["stop"]))},[o.renderSlot(e.$slots,"deleteIcon",{},(()=>[o.createVNode(s)]))])):o.createCommentVNode("",!0)]),t.node.expanded?(o.openBlock(),o.createBlock("ul",{key:0,style:{gap:t.gap+"px"},class:"tree-list"},[(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(t.node.nodes,(n=>(o.openBlock(),o.createBlock(i,{ref:"tree-row-"+n.id,key:n.id,node:n,"use-checkbox":t.useCheckbox,"use-icon":t.useIcon,"use-row-delete":t.useRowDelete,"show-child-count":t.showChildCount,gap:t.gap,"expand-row-by-default":t.expandRowByDefault,"indent-size":t.indentSize,"row-hover-background":t.rowHoverBackground,"set-node":t.setNode,"get-node":t.getNode,"update-node":t.updateNode,expandable:t.expandable,onDeleteRow:d.removedRow,onNodeExpanded:d.onNodeExpanded,onCheckboxToggle:d.onCheckboxToggle},{childCount:o.withCtx((({count:n,checkedCount:t,childs:d})=>[o.renderSlot(e.$slots,"childCount",{count:n,checkedCount:t,childs:d})])),iconActive:o.withCtx((()=>[o.renderSlot(e.$slots,"iconActive",{},(()=>[o.createVNode(a)]))])),iconInactive:o.withCtx((()=>[o.renderSlot(e.$slots,"iconInactive",{},(()=>[o.createVNode(l)]))])),deleteIcon:o.withCtx((()=>[o.renderSlot(e.$slots,"deleteIcon",{},(()=>[o.createVNode(s)]))])),checkbox:o.withCtx((({checked:n,indeterminate:t,id:d})=>[o.renderSlot(e.$slots,"checkbox",{id:d,checked:n,indeterminate:t})])),_:2},1032,["node","use-checkbox","use-icon","use-row-delete","show-child-count","gap","expand-row-by-default","indent-size","row-hover-background","set-node","get-node","update-node","expandable","onDeleteRow","onNodeExpanded","onCheckboxToggle"])))),128))],4)):o.createCommentVNode("",!0)],4)};const C={name:"Tree",components:{TreeRow:p},props:{nodes:{type:Array,required:!0},props:{type:Object,default:()=>({nodes:"nodes",label:"label"})},indentSize:{type:Number,default:24},gap:{type:Number,default:10},searchText:{type:String,default:""},expandRowByDefault:{type:Boolean,default:!1},expandAllRowsOnSearch:{type:Boolean,default:!0},useCheckbox:{type:Boolean,default:!1},useIcon:{type:Boolean,default:!0},useRowDelete:{type:Boolean,default:!1},showChildCount:{type:Boolean,default:!1},rowHoverBackground:{type:String,default:"#e0e0e0"},expandable:{type:Boolean,default:!0}},emits:["nodeExpanded","checkboxToggle","update"],setup(e,{emit:n}){const{search:t}={search:(e,o,n)=>{const t=(e,d)=>{if(d[n.label].toLowerCase().includes(o.toLowerCase()))return e.push(d),e;if(Array.isArray(d[n.nodes])){const o=d[n.nodes].reduce(t,[]);o.length&&e.push(__spreadProps(__spreadValues({},d),{nodes:o}))}return e};return e.reduce(t,[])}},d=o.reactive({data:g(e.nodes)}),r=o.ref(e.expandRowByDefault),c=e=>x(d.data,e),a=(e,o)=>{d.data=m(b(d.data,e,o))};o.watch((()=>d.data),(()=>{n("update",d.data)})),o.watch((()=>e.searchText),(()=>{let o=d.data;""!==e.searchText?(o=t(e.nodes,e.searchText,e.props),e.expandAllRowsOnSearch&&(r.value=!0)):(o=e.nodes,r.value=!1),d.data=m(o)}));return{setNode:(e,o)=>{d.data.value=f(d.data,e,o)},getNode:c,updateNode:a,onNodeExpanded:(e,o)=>{n("nodeExpanded",e,o)},state:d,reactiveExpandRowByDefault:r,onCheckboxToggle:e=>{n("checkboxToggle",e)},onUpdate:()=>{n("update",d.data)},toggleCheckbox:e=>{const{checked:o}=c(e);a(e,{checked:!o})},onDeleteRow:e=>{v(d.data,e.id),d.data=m(v(d.data,e.id))}}}},B=o.withScopeId("data-v-c8eaf37c");o.pushScopeId("data-v-c8eaf37c");const _={class:"tree"};o.popScopeId();const N=B(((e,n,t,d,r,c)=>{const a=o.resolveComponent("tree-row");return o.openBlock(),o.createBlock("div",_,[o.createVNode("ul",{style:{gap:t.gap+"px"},class:"tree-list"},[(o.openBlock(!0),o.createBlock(o.Fragment,null,o.renderList(d.state.data,(n=>(o.openBlock(),o.createBlock(a,{ref:"tree-row-"+n.id,key:n.id,node:n,"use-checkbox":t.useCheckbox,"use-icon":t.useIcon,"use-row-delete":t.useRowDelete,"show-child-count":t.showChildCount,"indent-size":t.indentSize,gap:t.gap,"expand-row-by-default":d.reactiveExpandRowByDefault,"row-hover-background":t.rowHoverBackground,"set-node":d.setNode,"get-node":d.getNode,"update-node":d.updateNode,expandable:t.expandable,onDeleteRow:d.onDeleteRow,onNodeExpanded:d.onNodeExpanded,onCheckboxToggle:d.onCheckboxToggle},o.createSlots({checkbox:B((({id:n,checked:t,indeterminate:r})=>[o.renderSlot(e.$slots,"checkbox",{checked:t,indeterminate:r,toggleCheckbox:()=>d.toggleCheckbox(n)},void 0,!0)])),_:2},[t.useIcon?{name:"iconActive",fn:B((()=>[o.renderSlot(e.$slots,"iconActive",{},void 0,!0)]))}:void 0,t.useIcon?{name:"iconInactive",fn:B((()=>[o.renderSlot(e.$slots,"iconInactive",{},void 0,!0)]))}:void 0,t.useRowDelete?{name:"deleteIcon",fn:B((()=>[o.renderSlot(e.$slots,"deleteIcon",{},void 0,!0)]))}:void 0,t.showChildCount?{name:"childCount",fn:B((({count:n,checkedCount:t,childs:d})=>[o.renderSlot(e.$slots,"childCount",{count:n,checkedCount:t,childs:d},void 0,!0)]))}:void 0]),1032,["node","use-checkbox","use-icon","use-row-delete","show-child-count","indent-size","gap","expand-row-by-default","row-hover-background","set-node","get-node","update-node","expandable","onDeleteRow","onNodeExpanded","onCheckboxToggle"])))),128))],4)])}));C.render=N,C.__scopeId="data-v-c8eaf37c",e.default=C,e.getNodeById=x,e.setNodeById=f,e.updateNodeById=b,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
