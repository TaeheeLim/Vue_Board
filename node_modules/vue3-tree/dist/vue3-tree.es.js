var e=Object.defineProperty,o=Object.defineProperties,n=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,a=(o,n,t)=>n in o?e(o,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[n]=t,c=(e,o)=>{for(var n in o||(o={}))d.call(o,n)&&a(e,n,o[n]);if(t)for(var n of t(o))r.call(o,n)&&a(e,n,o[n]);return e},l=(e,t)=>o(e,n(t));import{openBlock as s,createBlock as i,createVNode as u,watch as p,computed as h,resolveComponent as g,withModifiers as x,Fragment as k,renderSlot as w,createCommentVNode as f,withDirectives as y,vModelCheckbox as b,toDisplayString as v,renderList as C,withCtx as m,nextTick as B,pushScopeId as R,popScopeId as N,reactive as A,ref as D,createSlots as I,withScopeId as E}from"vue";const T={},$={xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-right"},O=u("polyline",{points:"9 18 15 12 9 6"},null,-1);T.render=function(e,o){return s(),i("svg",$,[O])};const j={},S={xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-chevron-down"},z=u("polyline",{points:"6 9 12 15 18 9"},null,-1);j.render=function(e,o){return s(),i("svg",S,[z])};const q={},H={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-x"},P=u("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),_=u("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1);q.render=function(e,o){return s(),i("svg",H,[P,_])};const F={components:{ArrowRight:T,ArrowDown:j,DeleteIcon:q},props:{node:{type:Object,required:!0},indentSize:{type:Number,required:!0},gap:{type:Number,required:!0},getNode:{type:Function,required:!0},setNode:{type:Function,required:!0},updateNode:{type:Function,required:!0},expandRowByDefault:{type:Boolean,default:!1},useCheckbox:{type:Boolean,default:!1},useIcon:{type:Boolean,default:!0},useRowDelete:{type:Boolean,default:!1},showChildCount:{type:Boolean,default:!1},rowHoverBackground:{type:String,default:"#e0e0e0"},expandable:{type:Boolean,default:!0}},emits:["nodeExpanded","checkboxToggle","deleteRow"],setup(e,{emit:o}){p((()=>e.expandRowByDefault),(o=>{e.node.nodes&&(e.node.expanded=!e.expandable)}),{immediate:!0});return{childCount:h((()=>{var o;return null==(o=e.node.nodes)?void 0:o.length})),checkedChildCount:h((()=>{var o;return null==(o=e.node.nodes)?void 0:o.filter((e=>e.checked)).length})),toggleExpanded:n=>{e.expandable&&(e.node.expanded=!!e.node.nodes&&!e.node.expanded,B((()=>{o("nodeExpanded",n,e.node.expanded)})))},onNodeExpanded:(e,n)=>{o("nodeExpanded",e,n)},toggleCheckbox:()=>{const{node:o,updateNode:n}=e;n(o.id,{checked:!o.checked})},onCheckboxToggle:(e,n)=>{o("checkboxToggle",e,n)},removedRow:e=>{o("deleteRow",e)}}}},L={key:0,class:"tree-row-item-icon-wrapper"},U={class:"tree-row-txt"},V={class:"child-count"};function G(e){const o=e=>(e.forEach((e=>{e.checked=!1,e.expanded=!1,e.indeterminate=!1,Array.isArray(e.nodes)&&o(e.nodes)})),e);return o(e)}function J(e,o){for(let n=0;n<e.length;n++){const t=e[n];if(t.id===o)return t;if(Array.isArray(t.nodes)){const e=J(t.nodes,o);if(e)return e}}}function K(e,o,n){for(let t=0;t<e.length;t++){const d=e[t];d.id===o?e[t]=c({id:o},n):Array.isArray(d.nodes)&&(e[t].nodes=K(d.nodes,o,n))}return e}function M(e,o){const n=void 0!==o?o:e.checked;return e.checked=n,e&&Array.isArray(e.nodes)&&(e.nodes=e.nodes.map((e=>l(c({},e),{checked:n,nodes:e.nodes?e.nodes.map((e=>M(e,n))):void 0})))),e}function Q(e,o,n){for(let t=0;t<e.length;t++){const d=e[t];d.id===o?e[t]=M(c(c({},d),n)):Array.isArray(d.nodes)&&(e[t].nodes=Q(d.nodes,o,n))}return e}function W(e){return e.map((e=>{if(e.nodes){e.nodes=W(e.nodes);const o=e.nodes.every((e=>e.checked)),n=e.nodes.some((e=>e.checked)),t=e.nodes.some((e=>e.indeterminate));o?(e.checked=!0,e.indeterminate=!1):n||t?(e.checked=!1,e.indeterminate=!0):o||(e.checked=!1,e.indeterminate=!1)}else e.expanded&&(e.expanded=!1);return e}))}function X(e,o){if(!Array.isArray(e))return;let n=[...e];for(let t=0;t<e.length;t++){const d=e[t];d.id===o?n=n.filter((e=>e.id!==o)):d.nodes&&(d.nodes=X(d.nodes,o),d.nodes.length||delete d.nodes)}return n}F.render=function(e,o,n,t,d,r){const a=g("arrow-right"),c=g("arrow-down"),l=g("delete-icon"),p=g("tree-row",!0);return s(),i("li",{class:"tree-row",style:{"padding-left":n.indentSize+"px",gap:n.gap+"px","--row-hover-background":n.rowHoverBackground}},[u("div",{class:"tree-row-item",onClick:o[4]||(o[4]=x((e=>t.toggleExpanded(n.node)),["stop"]))},[n.useIcon?(s(),i("div",L,[n.node.nodes?(s(),i(k,{key:0},[n.node.expanded?w(e.$slots,"iconInactive",{key:1},(()=>[u(c)])):w(e.$slots,"iconActive",{key:0},(()=>[u(a)]))],64)):f("",!0)])):f("",!0),w(e.$slots,"checkbox",{id:n.node.id,checked:n.node.checked,indeterminate:n.node.indeterminate}),n.useCheckbox?y((s(),i("input",{key:1,"onUpdate:modelValue":o[1]||(o[1]=e=>n.node.checked=e),type:"checkbox",checked:n.node.checked,indeterminate:n.node.indeterminate,onClick:o[2]||(o[2]=x(((...e)=>t.toggleCheckbox&&t.toggleCheckbox(...e)),["stop"]))},null,8,["checked","indeterminate"])),[[b,n.node.checked]]):f("",!0),u("span",U,v(n.node.label),1),n.node.nodes&&n.showChildCount?w(e.$slots,"childCount",{key:2,count:t.childCount,checkedCount:t.checkedChildCount,childs:n.node.nodes},(()=>[u("span",V,v(t.childCount),1)])):f("",!0),n.node&&n.useRowDelete?(s(),i("div",{key:3,class:"delete-icon",onClick:o[3]||(o[3]=x((e=>t.removedRow(n.node)),["stop"]))},[w(e.$slots,"deleteIcon",{},(()=>[u(l)]))])):f("",!0)]),n.node.expanded?(s(),i("ul",{key:0,style:{gap:n.gap+"px"},class:"tree-list"},[(s(!0),i(k,null,C(n.node.nodes,(o=>(s(),i(p,{ref:"tree-row-"+o.id,key:o.id,node:o,"use-checkbox":n.useCheckbox,"use-icon":n.useIcon,"use-row-delete":n.useRowDelete,"show-child-count":n.showChildCount,gap:n.gap,"expand-row-by-default":n.expandRowByDefault,"indent-size":n.indentSize,"row-hover-background":n.rowHoverBackground,"set-node":n.setNode,"get-node":n.getNode,"update-node":n.updateNode,expandable:n.expandable,onDeleteRow:t.removedRow,onNodeExpanded:t.onNodeExpanded,onCheckboxToggle:t.onCheckboxToggle},{childCount:m((({count:o,checkedCount:n,childs:t})=>[w(e.$slots,"childCount",{count:o,checkedCount:n,childs:t})])),iconActive:m((()=>[w(e.$slots,"iconActive",{},(()=>[u(a)]))])),iconInactive:m((()=>[w(e.$slots,"iconInactive",{},(()=>[u(c)]))])),deleteIcon:m((()=>[w(e.$slots,"deleteIcon",{},(()=>[u(l)]))])),checkbox:m((({checked:o,indeterminate:n,id:t})=>[w(e.$slots,"checkbox",{id:t,checked:o,indeterminate:n})])),_:2},1032,["node","use-checkbox","use-icon","use-row-delete","show-child-count","gap","expand-row-by-default","indent-size","row-hover-background","set-node","get-node","update-node","expandable","onDeleteRow","onNodeExpanded","onCheckboxToggle"])))),128))],4)):f("",!0)],4)};const Y={name:"Tree",components:{TreeRow:F},props:{nodes:{type:Array,required:!0},props:{type:Object,default:()=>({nodes:"nodes",label:"label"})},indentSize:{type:Number,default:24},gap:{type:Number,default:10},searchText:{type:String,default:""},expandRowByDefault:{type:Boolean,default:!1},expandAllRowsOnSearch:{type:Boolean,default:!0},useCheckbox:{type:Boolean,default:!1},useIcon:{type:Boolean,default:!0},useRowDelete:{type:Boolean,default:!1},showChildCount:{type:Boolean,default:!1},rowHoverBackground:{type:String,default:"#e0e0e0"},expandable:{type:Boolean,default:!0}},emits:["nodeExpanded","checkboxToggle","update"],setup(e,{emit:o}){const{search:n}={search:(e,o,n)=>{const t=(e,d)=>{if(d[n.label].toLowerCase().includes(o.toLowerCase()))return e.push(d),e;if(Array.isArray(d[n.nodes])){const o=d[n.nodes].reduce(t,[]);o.length&&e.push(l(c({},d),{nodes:o}))}return e};return e.reduce(t,[])}},t=A({data:G(e.nodes)}),d=D(e.expandRowByDefault),r=e=>J(t.data,e),a=(e,o)=>{t.data=W(Q(t.data,e,o))};p((()=>t.data),(()=>{o("update",t.data)})),p((()=>e.searchText),(()=>{let o=t.data;""!==e.searchText?(o=n(e.nodes,e.searchText,e.props),e.expandAllRowsOnSearch&&(d.value=!0)):(o=e.nodes,d.value=!1),t.data=W(o)}));return{setNode:(e,o)=>{t.data.value=K(t.data,e,o)},getNode:r,updateNode:a,onNodeExpanded:(e,n)=>{o("nodeExpanded",e,n)},state:t,reactiveExpandRowByDefault:d,onCheckboxToggle:e=>{o("checkboxToggle",e)},onUpdate:()=>{o("update",t.data)},toggleCheckbox:e=>{const{checked:o}=r(e);a(e,{checked:!o})},onDeleteRow:e=>{X(t.data,e.id),t.data=W(X(t.data,e.id))}}}},Z=E("data-v-c8eaf37c");R("data-v-c8eaf37c");const ee={class:"tree"};N();const oe=Z(((e,o,n,t,d,r)=>{const a=g("tree-row");return s(),i("div",ee,[u("ul",{style:{gap:n.gap+"px"},class:"tree-list"},[(s(!0),i(k,null,C(t.state.data,(o=>(s(),i(a,{ref:"tree-row-"+o.id,key:o.id,node:o,"use-checkbox":n.useCheckbox,"use-icon":n.useIcon,"use-row-delete":n.useRowDelete,"show-child-count":n.showChildCount,"indent-size":n.indentSize,gap:n.gap,"expand-row-by-default":t.reactiveExpandRowByDefault,"row-hover-background":n.rowHoverBackground,"set-node":t.setNode,"get-node":t.getNode,"update-node":t.updateNode,expandable:n.expandable,onDeleteRow:t.onDeleteRow,onNodeExpanded:t.onNodeExpanded,onCheckboxToggle:t.onCheckboxToggle},I({checkbox:Z((({id:o,checked:n,indeterminate:d})=>[w(e.$slots,"checkbox",{checked:n,indeterminate:d,toggleCheckbox:()=>t.toggleCheckbox(o)},void 0,!0)])),_:2},[n.useIcon?{name:"iconActive",fn:Z((()=>[w(e.$slots,"iconActive",{},void 0,!0)]))}:void 0,n.useIcon?{name:"iconInactive",fn:Z((()=>[w(e.$slots,"iconInactive",{},void 0,!0)]))}:void 0,n.useRowDelete?{name:"deleteIcon",fn:Z((()=>[w(e.$slots,"deleteIcon",{},void 0,!0)]))}:void 0,n.showChildCount?{name:"childCount",fn:Z((({count:o,checkedCount:n,childs:t})=>[w(e.$slots,"childCount",{count:o,checkedCount:n,childs:t},void 0,!0)]))}:void 0]),1032,["node","use-checkbox","use-icon","use-row-delete","show-child-count","indent-size","gap","expand-row-by-default","row-hover-background","set-node","get-node","update-node","expandable","onDeleteRow","onNodeExpanded","onCheckboxToggle"])))),128))],4)])}));Y.render=oe,Y.__scopeId="data-v-c8eaf37c";export default Y;export{J as getNodeById,K as setNodeById,Q as updateNodeById};
